import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

#Batch Size vs Training Time
df = pd.read_csv("Results.csv")
sns.set_style("whitegrid")

plt.figure(figsize=(8,6))
ax = sns.lineplot(
    data=df,
    x='Batch Size',
    y='Train_Time',
    hue='Epoch',
    marker='o',
    dashes=False,
)

for i, point in df.iterrows():
    plt.text(
        x=point['Batch Size'],
        y=point['Train_Time'],
        s=f"{point['Train_Time']:.2f}",
        horizontalalignment='center',
        verticalalignment='bottom',
        fontsize=14,
        color='black'
    )
plt.xscale('log', base=2)
plt.xticks(df['Batch Size'].unique(),df['Batch Size'].unique())
ax.yaxis.grid(True, color='gray', linestyle='-', alpha=0.5)
plt.title('Batch Size vs. Training Time', fontsize=14)
plt.xlabel('Batch Size')
plt.ylabel('Training and Validation Time (s)')
plt.legend(title='Epochs')
plt.tight_layout()
plt.show()

#Batch Size vs Test Accuracy
plt.figure(figsize=(8,6))
ax = sns.lineplot(
    data=df,
    x='Batch Size',
    y='Test_Accuracy',
    hue='Epoch',
    marker='o',
    dashes=False,
)

for i, point in df.iterrows():
    plt.text(
        x=point['Batch Size'],
        y=point['Test_Accuracy'],
        s=f"{point['Test_Accuracy']:.2f}",
        horizontalalignment='center',
        verticalalignment='bottom',
        fontsize=14,
        color='black'
    )

# 4. Apply Horizontal Grid Style (like the screenshot)
plt.xscale('log', base=2)
plt.xticks(df['Batch Size'].unique(),df['Batch Size'].unique())
ax.yaxis.grid(True, color='gray', linestyle='-', alpha=0.5)
plt.title('Batch Size vs Model Accuracy ', fontsize=14)
plt.xlabel('Batch Size')
plt.ylabel('Test Accuracy')
plt.legend(title='Epochs')
plt.tight_layout()
plt.show()

plt.figure(figsize=(8,6))
sns.lineplot(
    data=df,
    x='Batch Size',
    y='Train_Time',
    hue='Epoch',
    marker='o',
    dashes=False,
)
plt.xscale('log', base=2)
plt.xticks(df['Batch Size'].unique(),df['Batch Size'].unique())
plt.title('Batch Size vs. Training Time', fontsize=14)
plt.xlabel('Batch Size (log Scale)')
plt.ylabel('Training and Validation Time (s)')
plt.legend(title='Epochs')
plt.tight_layout()
plt.show()

# Batch Size vs Test Accuracy
plt.figure(figsize=(8,6))
ax = sns.lineplot(
    data=df,
    x='Batch Size',
    y='Test_Accuracy',
    hue='Epoch',
    marker='o',
    dashes=False,
)
plt.xscale('log', base=2)
plt.xticks(df['Batch Size'].unique(),df['Batch Size'].unique())
ax.yaxis.grid(True, color='gray', linestyle='-', alpha=0.5)
ax.set_axisbelow(True)
plt.title('Batch Size vs. Model Accuracy', fontsize=14)
plt.xlabel('Batch Size (log Scale)')
plt.ylabel('Test Accuracy')
plt.legend(title='Epochs')
plt.tight_layout()
plt.show()
